<ion-content hide-nav-bar="true" padding [ngSwitch]="citP.current_div" [ngStyle]="{ 'background-color': citP.bg_color }" text-wrap>

  <div *ngSwitchCase="'div_settings'" style="font-size: 200% !important;">
    <div style="font-size: 90%;line-height:150%;font-weight:bold">
      Légy szíves kapcsold ki az internetet illetve állítsd a telefonod "repülő" módba, hogy semmi ne szakítsa meg a tesztet.
      Ezt követően kérjük add meg az információkat alább.
    </div>
    <br />

    <ion-item>
      <ion-label style="font-size: 160% !important;margin-bottom:0;color:black;" fixed>Életkor</ion-label>
      <ion-input [(ngModel)]="citP.age" type="number" [ngModelOptions]="{standalone: true}" style="font-style:normal;" text-right></ion-input>
    </ion-item>
    <br />
    <ion-item>
      <ion-label style="font-size: 160% !important;margin-bottom:0;color:black">Nem</ion-label>
      <ion-select [(ngModel)]="citP.gender" [ngModelOptions]="{standalone: true}" interface='popover' style="font-size: 140%;">
        <ion-option value='1'>Férfi</ion-option>
        <ion-option value='2'>Nő</ion-option>
      </ion-select>
    </ion-item>
    <br />
    <ion-item>
      <ion-label style="font-size: 160% !important;margin-bottom:0;color:black">Foglalkozás</ion-label>
      <ion-select [(ngModel)]="citP.occupation" [ngModelOptions]="{standalone: true}" interface='popover' style="font-size: 140%;">
        <ion-option value='1'>Tanuló</ion-option>
        <ion-option value='2'>Dolgozó (teljes munkaidő)</ion-option>
        <ion-option value='3'>Egyéb</ion-option>
      </ion-select>
    </ion-item>
    <br />
    <ion-item>
      <ion-label style="font-size: 160% !important;margin-bottom:0;color:black">Képzettség</ion-label>
      <ion-select [(ngModel)]="citP.education" [ngModelOptions]="{standalone: true}" interface='popover' style="font-size: 140%;">
        <ion-option value='0'>Általános iskola</ion-option>
        <ion-option value='1'>Középiskola</ion-option>
        <ion-option value='2'>Szakmunkásképző / professzionális képzés</ion-option>
        <ion-option value='3'>Megkezdett egyetem/főiskola</ion-option>
        <ion-option value='4'>Alapképzés (BA, BSc, stb.) szintű végzettség</ion-option>
        <ion-option value='5'>Mesterképzés (MA, MSc, stb.) szintű végzettség</ion-option>
      </ion-select>
    </ion-item>

    <div *ngIf='citP.age > 16 && citP.age < 60 && citP.gender != "" && citP.occupation != "" && citP.education != ""'>
      <br />
      <br />
      <div style="font-size: 90%;line-height:150%;font-weight:bold;text-align:left">
        <b>
          Most következik a hazugságvizsgálat.
          <br />
          Ne felejtsd el, hogy tagadod, hogy megérted a német nyelvet.
        </b>
      </div>

      <br />
      <br />
      <div style="text-align:center">
        <button large ion-button type="button" (tap)="citP.switch_divs('div_items');" style="font-size: 120% !important;">OK</button>
      </div>
    </div>

    <br />
    <br />
    <br />
    <br />
  </div>

  <div *ngSwitchCase="'div_items'" style="font-size: 200% !important;" [ngStyle]="{'pointer-events': citP.pointev.div_items || 'none' }">

    <div style="font-size: 90%;line-height:150%;font-weight:bold">
      Kérjük olvasd végig a következő szólistát. Ha látsz olyan szavakat, amelyek értelmesnek tűnnek neked (vagy bármi módon jelentősen különbözőnek látszik a többi szóhoz képest), válaszd ki őket. Összesen maximum négy szót válaszhatsz ki.
    </div>
    <br />

    <ion-list>
      <ion-item *ngFor="let the_item of dataShare.allpossiblewords">
        <ion-label style="font-size: 150% !important;">{{the_item}}</ion-label>
        <ion-checkbox [disabled]="dataShare.checkboxed.length >= 4 && dataShare.checkboxed.indexOf(the_item) === -1" (ionChange)="dataShare.chb_change($event, the_item)" item-right></ion-checkbox>
      </ion-item>
    </ion-list>

    <div style="text-align:center">
      <hr />
      <br />
      <button ion-button type="button" (tap)="initials();" style="font-size: 120% !important;" large>OK</button>
    </div>
  </div>


  <div *ngSwitchCase="'div_consent'">
    <span style="line-height: 150%;">
      {{trP.consent[trP.lang]}} {{consentitems}}
    </span>
    <br /><br />
    <div text-center>
      {{trP.consent_q[trP.lang]}}
      <br /><br />
      <button ion-button *ngIf="consentset.indexOf('1') !== -1" (tap)="init_cit(1);" color='light' block>{{trP.consent_a[trP.lang][0]}}</button>
      <br />
      <button ion-button *ngIf="consentset.indexOf('2') !== -1 && consentset.indexOf('1') !== -1" (tap)="init_cit(2);" color='light' block>{{trP.consent_a[trP.lang][1]}}</button>
      <button ion-button *ngIf="consentset.indexOf('2') !== -1 && consentset.indexOf('1') === -1" (tap)="init_cit(2);" color='light' block>{{trP.consent_a[trP.lang][0]}}</button>
      <br />
      <button ion-button *ngIf="consentset.indexOf('0') !== -1" (tap)="init_cit(0);" color='light' block>{{trP.consent_a[trP.lang][2]}}</button>
      <br />
    </div>
  </div>


  <div *ngSwitchCase="'div_blockstart'" [ngStyle]="{'pointer-events': citP.pointev.div_blockstart || 'none' }">

    <div *ngIf='citP.block_text.slice(0, 13) === "<span></span>"'>
      <button ion-button style='text-transform: none;' (tap)='citP.block_text = citP.block_texts[citP.blocknum]' color='light' block>{{trP.show_inst[trP.lang]}}</button>
      <br />
    </div>

    <span [innerHTML]="san_html(citP.block_text)"></span>
    <div text-center>
      <br />
      <br />
      <button ion-button (tap)="citP.runblock();">{{trP.start[trP.lang]}}</button>
      <br />
    </div>
  </div>


  <div *ngSwitchCase="'div_cit_main'">

    <p (touchstart)="citP.touchstart($event, 'resp_a');" (touchend)="citP.touchend($event, 'resp_a');" id="resp_left" class="resp_buttons"></p>

    <p (touchstart)="citP.touchstart($event, 'resp_b');" (touchend)="citP.touchend($event, 'resp_b');" id="resp_right" class="resp_buttons"></p>

    <canvas width="10" height="10" #thecanvas></canvas>
    <p id="feed_id"><b>{{citP.feed_text}}</b></p>

    <p id="stimulus">{{citP.stimulus_text}}</p>

    <p id="start_text" (tap)="citP.visib.start_text = false; citP.start_trials();" *ngIf="citP.visib.start_text">{{trP.taptostart[trP.lang]}}</p>
  </div>


  <div *ngSwitchCase="'cit_end'">
    A hazugságvizsgálat véget ért! Mivel a résztvevők fele nem beszél németül, a kutatás érdekében nagyon fontos pontosan rögzítenünk, hogy <b>valójában beszélsz-e németül vagy nem</b>. Ezért kérjük szimplán add meg ezt az adatot alább. (Ez nem
    fogja befolyásolni a befejezett teszt eredményeit, amik már el lettek mentve.) A kifizetés előtt a kísérletvezető is ellenőrizni fogja helyesen adtad-e meg ezt az információt.

    <ion-item>
      <ion-label style="font-size: 120% !important;margin-bottom:0;color:black">Beszélek németül</ion-label>
      <ion-select [(ngModel)]="citP.speaker" [ngModelOptions]="{standalone: true}" interface='popover' style="font-size: 140%;">
        <ion-option value='yes'>Igen</ion-option>
        <ion-option value='no'>Nem</ion-option>
      </ion-select>
    </ion-item>

    <div *ngIf="citP.speaker !==''"><br /><br />
      Azt adtad meg, hogy <b><span *ngIf="citP.speaker === 'yes'">valójában</span><span *ngIf="citP.speaker === 'no'">tényleg nem</span> beszélsz németül</b>. Ha ez stimmel, érintsd meg az alábbi gombot.
      <br />
      <br />
      <button ion-button (tap)='citP.switch_divs("div_pcheck");' color='light' block>RENDBEN</button>
    </div>


  </div>


  <div *ngSwitchCase="'div_pcheck'" [ngStyle]="{'pointer-events': citP.pointev.div_pcheck || 'none' }">
    Függetlenül attól, hogy beszélsz-e németül, tudni szeretnénk, felismerted-e vagy akár sejtetted-e melyik szó volt német a különböző tesztszakaszokban. Légy szíves, válaszd ki a 4 ismert vagy sejtett valódi német szót az alábbi 4 listából. Ha
    nincs sejtésed se, válaszd
    a "nem tudom" opciót.
    <br />

    <ion-item>
      <ion-label style="font-size: 100% !important;margin-bottom:0;color:black">1.</ion-label>
      <ion-select [(ngModel)]="citP.pchosen[0]" [ngModelOptions]="{standalone: true}" interface='popover' style="font-size: 140%;">
        <ion-option *ngFor="let mainword of words_lists[0]" value={{mainword}}>{{mainword}}</ion-option>
      </ion-select>
    </ion-item>
    <br />

    <ion-item>
      <ion-label style="font-size: 100% !important;margin-bottom:0;color:black">2.</ion-label>
      <ion-select [(ngModel)]="citP.pchosen[1]" [ngModelOptions]="{standalone: true}" interface='popover' style="font-size: 140%;">
        <ion-option *ngFor="let mainword of words_lists[1]" value={{mainword}}>{{mainword}}</ion-option>
      </ion-select>
    </ion-item>
    <br />

    <ion-item>
      <ion-label style="font-size: 100% !important;margin-bottom:0;color:black">3.</ion-label>
      <ion-select [(ngModel)]="citP.pchosen[2]" [ngModelOptions]="{standalone: true}" interface='popover' style="font-size: 140%;">
        <ion-option *ngFor="let mainword of words_lists[2]" value={{mainword}}>{{mainword}}</ion-option>
      </ion-select>
    </ion-item>
    <br />

    <ion-item>
      <ion-label style="font-size: 100% !important;margin-bottom:0;color:black">4.</ion-label>
      <ion-select [(ngModel)]="citP.pchosen[3]" [ngModelOptions]="{standalone: true}" interface='popover' style="font-size: 140%;">
        <ion-option *ngFor="let mainword of words_lists[3]" value={{mainword}}>{{mainword}}</ion-option>
      </ion-select>
    </ion-item>
    <br />
    <br />

    <button *ngIf="citP.pchosen.indexOf('') === -1" ion-button (tap)='citP.lex_switch();' color='light' block>OK</button>
  </div>


  <div *ngSwitchCase="'div_lextale_intro'" [ngStyle]="{'pointer-events': citP.pointev.div_lextale_intro || 'none' }">
    Befejezésül egy rövid és egyszerű német megértési teszt következik, a némettudásod hozzávetőleges felméréséhez.
    <br />
    Alább német instrukciók következnek.
    <br />
    <br />
    <hr />
    <hr />
    <hr />
    <br />

    Dieser Test besteht aus ungefähr 60 Durchgängen, in denen Sie jeweils eine Buchstabenreihe sehen. Ihre Aufgabe ist es, zu entscheiden, ob diese Buchstabenreihe ein existierendes deutsches Wort ist oder nicht. Falls sie glauben, dass es ein
    deutsches Wort ist, klicken Sie auf "ja", andernfalls auf "nein".
    <br /><br />
    Sollten Sie sich sicher sein, dass ein Wort existiert, aber seine Bedeutung nicht kennen, können Sie trotzdem mit "ja" antworten. Sind Sie sich aber unsicher, ob das
    Wort überhaupt im Deutschen existiert, sollten Sie mit "nein" antworten.
    <br /><br />
    Sie haben so viel Zeit wie Sie möchten für jede Antwort. Der Test dauert etwa 5 Minuten.
    <br /><br />
    Wenn Sie bereit sind, können Sie selbst das Experiment
    starten.
    <br /><br />
    <button ion-button (tap)='citP.lex_start();' color='light' block>OK</button>

  </div>


  <div *ngSwitchCase="'div_lex_main'" [ngStyle]="{'pointer-events': citP.pointev.div_lex_main || 'none' }">

    <span (tap)="citP.lextouch('no');" class="lexresp_buttons lexresp_left"></span>

    <span (tap)="citP.lextouch('yes');" class="lexresp_buttons lexresp_right"></span>

    <p (tap)="citP.lextouch('no');" class="labels lexresp_left">Nein</p>

    <p (tap)="citP.lextouch('yes');" class="labels lexresp_right">Ja</p>

    <p id="lexstim">{{citP.lexstim_item.word}}</p>

  </div>

  <div *ngSwitchCase="'div_end'">
    <div style="padding:2vw" (swiperight)="sethome();">
      A teszt véget ért. Visszakapcsolhatod az internetet, ami szükséges lesz az adatok elküldéséhez.
      <br /><br />
      Kérjük várj csendben amíg mindenki befejezi a tesztet. (A biztonság kedvéért lehetőleg ne zárd be ezt az appot, de ha szeretnéd használni a telefonod, háttérbe rakhatod, azaz átválthatsz másik appra.)
    </div>
  </div>


  <div *ngSwitchCase="'div_results'" [ngStyle]="{'pointer-events': citP.pointev.div_results || 'none' }">

    <div [hidden]="citP.current_menu != 'm_testres'">

      <div style="clear:both;font-size:110%;text-align:center;padding-bottom:1.5vw;padding-top:1.5vw">
        Summary CIT results for <b>{{citP.cit_results.subj_id}}</b>
      </div>
      <div style="text-align:center;padding-bottom:4.5vw">
        (Date: <b>{{citP.cit_results.date}}</b>)
      </div>

      <div style="overflow-x:auto;background:#f1f1f1">
        <table class='results_table'>
          <tr>
            <th></th>
            <th>RT<sub>P&nbsp;vs&nbsp;I</sub><br /><span class='res_unit'>(ms)</span></th>
            <th>RT<sub>P&nbsp;(SD)</sub><br /><span class='res_unit'>(ms)</span></th>
            <th>RT<sub>I&nbsp;(SD)</sub><br /><span class='res_unit'>(ms)</span></th>
            <th><i>d</i><sub>CIT</sub><br /><span class='res_unit'>&nbsp;</span></th>
            <th>AR<sub>P&nbsp;vs&nbsp;I</sub><br /><span class='res_unit'>(%)</span></th>
            <th>AR<sub>P</sub><br /><span class='res_unit'>(%)</span></th>
            <th>AR<sub>I</sub><br /><span class='res_unit'>(%)</span></th>
          </tr>
          <tr *ngFor="let num of [1, 2, 3, 4, 5];">
            <td>
              Probe&nbsp;{{num}}
            </td>
            <td>
              {{citP.cit_results['probe' + num]['rt_p_vs_i']}}
            </td>
            <td>
              {{citP.cit_results['probe' + num]['rt_probe']}}&nbsp;({{citP.cit_results['probe' + num]['rt_probe_sd']}})
            </td>
            <td>
              {{citP.cit_results['probe' + num]['rt_irr']}}&nbsp;({{citP.cit_results['probe' + num]['rt_irr_sd']}})
            </td>
            <td style="color:#8b0000;">
              {{citP.cit_results['probe' + num]['dcit']}}
            </td>
            <td>
              {{citP.cit_results['probe' + num]['acc_p_vs_i']}}
            </td>
            <td>
              {{citP.cit_results['probe' + num]['acc_probe']}}
            </td>
            <td>
              {{citP.cit_results['probe' + num]['acc_irr']}}
            </td>
          </tr>
        </table>
      </div>
      <br />

      Overall accuracy rates (number of correct responses per number of all trials): {{citP.cit_results.ar_overall}}.
      <br />
      <br />
      <div (tap)="ele.class = ele.class == 'show' ? '' :  'show'" [ngClass]="{ expandable : true, hideChildren : ele.class !== 'show', showChildren : ele.class === 'show' }" #ele>
        <b>Description of variables</b>
        <span id='expand'><b>(tap to show)</b></span>
        <span id='collapse'><b>(tap to hide)</b></span>
        <div>
          Response times (for all correct responses, in milliseconds): probe RT mean minus irrelevant RT mean (RT<sub>P&nbsp;vs&nbsp;I</sub>), probe RT mean and standard deviation (RT<sub>P&nbsp;(SD)</sub>), irrelevant RT mean and standard
          deviation (RT<sub>I&nbsp;(SD)</sub>),
          uncorrected Cohen's d between all probe and all irrelevant RTs (<i>d</i><sub>CIT</sub>). Accuracy rates (ratio of correct responses compared to incorrect and too slow responses, in percentage): probe accuracy rate minus irrelevant
          accuracy
          rate (AR<sub>P&nbsp;vs&nbsp;I</sub>), probe accuracy rate (AR<sub>P</sub>), irrelevant accuracy rate (AR<sub>I</sub>). Responses with RT below 150 ms are excluded from all RT and AR analysis, except for the overall accuracy rate
          calculation. Trials (i.e., responses) from practice rounds are not included in any of the statistics above.
        </div>
      </div>

      <br />

      <div (tap)="ele2.class = ele2.class == 'show' ? '' :  'show'" [ngClass]="{ expandable : true, hideChildren : ele2.class !== 'show', showChildren : ele2.class === 'show' }" #ele2>
        <b>Evaluation using <i>d</i><sub>CIT</sub></b>
        <span id='expand'><b>(tap to show)</b></span>
        <span id='collapse'><b>(tap to hide)</b></span>
        <div>
          The <i>d</i><sub>CIT</sub> measure might be used to evaluate whether or not a given probe was recognized. The <i>d</i><sub>CIT</sub> typically falls between around −0.3 and 0.8, where a larger number always indicates a larger likelihood
          of
          the
          recognition of the given probe. As of yet, there is no established optimal cut-off value for the evaluation, but, based on a rough approximation in view of previous results, the following table depicts some possible evaluative labels for
          given boundaries.
          <br />
          <br />

          <div style="overflow-x:auto;white-space: nowrap;">
            <table class='dcit_table'>
              <tr>
                <td><i>d</i><sub>CIT</sub> > 0.4</td>
                <td>strong indication of recognition</td>
              </tr>
              <tr>
                <td><i>d</i><sub>CIT</sub> > 0.3 and <i>d</i><sub>CIT</sub>
                  <= 0.4</td> <td>fair indication of recognition
                </td>
              </tr>
              <tr>
                <td><i>d</i><sub>CIT</sub> > 0.1 and <i>d</i><sub>CIT</sub>
                  <= 0.3</td> <td>weak indication of recognition
                </td>
              </tr>
              <tr>
                <td><i>d</i><sub>CIT</sub> > 0 and <i>d</i><sub>CIT</sub>
                  <= 0.1</td> <td>indeterminate
                </td>
              </tr>
              <tr>
                <td><i>d</i><sub>CIT</sub> > −0.1 and <i>d</i><sub>CIT</sub>
                  <= 0</td> <td>weak indication of non-recognition
                </td>
              </tr>
              <tr>
                <td><i>d</i><sub>CIT</sub>
                  <= −0.1</td> <td>fair indication of non-recognition
                </td>
              </tr>
            </table>
          </div>

          <br />
          (There is no strong indication of innocence: a very fast probe response is no more expected in case of innocence than in case of guilt.)
        </div>
      </div>
      <br />
      <br />
      To evaluate the results in this experiment, <i>d</i><sub>CIT</sub> for <i>Probe 1</i> (the real words in each block) should be at least below 0.30 to consider a person "not detected" and hence eligible for bonus. In contrast, anyone with <i>d</i><sub>CIT</sub>
      equal to or greater than 0.30 should not receive bonus.
      <br />
      <br />
      For more details, see the <a href="https://github.com/gasparl/citapp_phone" target="_blank">online
        documentation</a>.
      <br />
      <br />
      <hr />
      <br />

      <div style="padding-bottom:3.5vw">
        <i>Path to full data file:</i><br />
        <div style="overflow-x:auto" class='selectable'>
          <b>{{citP.path}}</b>
        </div>
      </div>

      <div style="padding-bottom:3.5vw">
        <i>File name:</i><br />
        <div style="overflow-x:auto" class='selectable'>
          <b>{{citP.cit_results.file_nam_disp}}</b>
        </div>
      </div>
      <hr />
      <button ion-button small type='button' (tap)="goto_menu('m_sendin')" color="light" block>Get full data</button>
    </div>


    <div [hidden]="citP.current_menu != 'm_sendin'">

      <div style="font-size:110%;text-align:center;padding-bottom:1.5vw;padding-top:1.5vw">
        Forward data with subject ID <b>{{citP.cit_results.subj_id}}</b>
      </div>
      <div style="text-align:center;padding-bottom:4.5vw">
        (Date: <b>{{citP.cit_results.date}}</b>)
      </div>

      <div style="text-align:left;padding-left: 16px;padding-top:1.5vw;">
        First, please try to upload the data to the server by pressing the button below. If the upload is successful, the button will disappear and a success message will appear in its place. If the upload fails, you will get an error message:
        in that case either try again or send data using one of the other options below.
      </div>
      <i>
        <p *ngIf="!internet_on" style="color: red;">It seems you are not connected to the internet.<br /></p>
      </i>
      <br />
      <span id="storefeed_id" style="color:red;">&nbsp;</span>
      <button *ngIf="notsent" ion-button type='button' (tap)="sendviaphp()" color="light" block>Send to server</button>
      <br /><br />
      <hr />
      <br />
      <div style="text-align:left;padding-left: 16px;padding-top:1.5vw;">
        The data can also be sent (shared, stored) via any chosen local application (e.g. email, cloud storage, etc.).
      </div>
      <span>&nbsp;</span>
      <button ion-button type='button' (tap)="sendviaapp()" color="light" block>Choose application</button>

      <br />
      <div style="text-align:left;padding-left: 16px;padding-top:1.5vw;">
        You can also just simply copy the data to the clipboard. Afterwards it can be pasted into any other application.
      </div>
      <span id="copyfeed_id" style="color:green;">&nbsp;</span>
      <button ion-button type='button' (tap)="to_clipboard()" color="light" block>Copy to clipboard</button>

      <br />
      <hr />
      <br />

      <div style="padding-bottom:3.5vw">
        <i>Path to all CIT results files on the device:</i><br />
        <div style="overflow-x:auto" class='selectable'>
          <b>{{citP.path}}</b>
        </div>
      </div>

      <div style="padding-bottom:3.5vw">
        <i>File name:</i><br />
        <div style="overflow-x:auto" class='selectable'>
          <b>{{citP.cit_results.file_nam_disp}}</b>
        </div>
      </div>
      <hr />
      <button ion-button small type='button' (tap)="goto_menu('m_testres')" color="light" block>Show main results</button>
    </div>

    <br />
    <br />
    <br />
    <br />
  </div>

  <!-- app console for testing
  <b>{{mycl}}</b>
  <br />
  <input (keypress)="onChange($event)" [(ngModel)]="to_exec" type="text" style="color:red; position:absolute;width:100%;">
  <br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
  console end -->

</ion-content>
