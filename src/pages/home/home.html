<ion-content hide-nav-bar="true" padding [ngSwitch]="citP.current_div" [ngStyle]="{ 'background-color': citP.bg_color }" text-wrap>



  <div *ngSwitchCase="'div_consent'">
    <span style="line-height: 150%;">
      <i>Here you should add whatever consent form you wish to have. A basic template follows...</i>
      <br>

      <h1>Information and Consent</h1>

      <p>
        <b>Aim of the Study:</b>
        <br>
        In this experiment, we use a response time based "lie detection" test to try to detect whether or not a participant recognizes certain names and faces, in a simulated lie detection scenario. Here, famous identities will serve as items whose
        knowledge you need to be concealing. Please try to imagine yourself in a scenario where you would want to conceal recognizing any of the people presented in the test.
      </p>

      <p>
        <b>Payment:</b>
        <br>
        The entire task takes around 25-30 minutes on average. (compensation?)
      </p>

      <p>
        <b>Your Rights:</b>
        <br>You are free to stop participating in the study at any time and without giving reasons.
      </p>

      <p>
        <b>Data Sharing and Anonymity:</b>
        <br>The data from the following test will be used and published to be freely available for research purposes. The data will not reveal who you are, you will not be named and your identity will remain strictly confidential.
      </p>

      <p>
        <b>Technical Issues:</b>
        <br>This application has been thoroughly tested and proven stable many times, but we do not take responsibility for potential unexpected technical issues. However, you are welcome to contact us for technical help.
      </p>

      <p>
        <b>Contact:</b>
        <br>Name and contact details of the Principal Researcher: ?
        <br>Name and contact for questions about the smartphone application: Gaspar Lukacs, University of Vienna (gaspar.lukacs@univie.ac.at).
      </p>

      <p>
        <b>Consent:</b>
        <br>
        By clicking the "I consent" button below, you confirm that you have read and understood the participation information. You also confirm that you will be concentrating on the tasks and complete them to the best of your abilities.
      </p>

      <br>

    </span>
    <br /><br />
    <div text-center>
      <button ion-button (tap)="citP.switch_divs('div_settings');" color='light' block>I consent</button>
      <br />
    </div>
  </div>

  <div *ngSwitchCase="'div_settings'" style="font-size: 200% !important;" [ngStyle]="{'pointer-events': citP.pointev.div_settings || 'none' }">
    <div style="font-size: 90%;line-height:150%;font-weight:bold">
      Please turn off the internet or set your phone to "flight mode" so that nothing would interrupt the test. Then please provide your Subject ID (from the Sona LABS System), age, and sex below. (If you do not wish to provide age, please set it to
      "1".)
    </div>
    <br />

    <ion-item>
      <ion-label style="font-size: 160% !important;margin-bottom:0;color:black;" fixed>Subject ID</ion-label>
      <ion-input [(ngModel)]="citP.subj_id" [ngModelOptions]="{standalone: true}" style="font-style:normal;" text-right></ion-input>
    </ion-item>
    <br />
    <ion-item>
      <ion-label style="font-size: 160% !important;margin-bottom:0;color:black;" fixed>Age</ion-label>
      <ion-input [(ngModel)]="citP.age" type="number" [ngModelOptions]="{standalone: true}" style="font-style:normal;" text-right></ion-input>
    </ion-item>
    <br />
    <ion-item>
      <ion-label style="font-size: 160% !important;margin-bottom:0;color:black">Sex</ion-label>
      <ion-select [(ngModel)]="citP.gender" [ngModelOptions]="{standalone: true}" interface='popover' style="font-size: 140%;">
        <ion-option value='1'>Male</ion-option>
        <ion-option value='2'>Female</ion-option>
        <ion-option value='3'>Other</ion-option>
      </ion-select>
    </ion-item>

    <div *ngIf='citP.subj_id.length > 2 && ((citP.age > 16 && citP.age < 90) || citP.age == 1 ) && citP.gender != ""'>
      <br />
      <br />
      <div style="font-size: 90%;line-height:150%;font-weight:bold;text-align:left">
        <b>
          Next comes the lie detection test.
          <br />
          Keep in mind that you are denying that you know any of the famous personalities.
        </b>
      </div>

      <br />
      <br />
      <div style="text-align:center">
        <button large ion-button type="button" (tap)="cit_start();" style="font-size: 120% !important;">
          OK
        </button>
      </div>
    </div>

    <br />
    <br />
    <br />
    <br />
  </div>


  <div *ngSwitchCase="'div_blockstart'" [ngStyle]="{'pointer-events': citP.pointev.div_blockstart || 'none' }">

    <div *ngIf='citP.block_text.slice(0, 13) === "<span></span>"'>
      <button ion-button style='text-transform: none;' (tap)='citP.block_text = citP.block_texts[citP.blocknum]' color='light' block>{{trP.show_inst[trP.lang]}}</button>
      <br />
    </div>

    <span [innerHTML]="san_html(citP.block_text)"></span>
    <div text-center>
      <br />
      <br />
      <button ion-button (tap)="citP.runblock();">{{trP.start[trP.lang]}}</button>
      <br />
    </div>
  </div>


  <div *ngSwitchCase="'div_cit_main'">


    <canvas width="10" height="10" #thecanvas></canvas>
    <p id="feed_id"><b>{{citP.feed_text}}</b></p>

    <p id="stimulus">{{citP.stimulus_text}}</p>

    <p (touchstart)="citP.touchstart($event, 'resp_a');" (touchend)="citP.touchend($event, 'resp_a');" id="resp_left" class="resp_buttons"></p>

    <p (touchstart)="citP.touchstart($event, 'resp_b');" (touchend)="citP.touchend($event, 'resp_b');" id="resp_right" class="resp_buttons"></p>

    <p id="start_text" (tap)="citP.visib.start_text = false; citP.start_trials();" *ngIf="citP.visib.start_text">{{trP.taptostart[trP.lang]}}</p>
  </div>


  <div *ngSwitchCase="'div_quests'" [ngStyle]="{'pointer-events': citP.pointev.div_quests || 'none' }">
    <br />
    <br />
    <h3>The lie detection test is now completed and the simulation scenario is over.</h3>
    <br />
    <br />
    <br />
    <b>On this last page, we have a short questionnaire for you. Please answer as honestly as possible!</b>
    <br />
    <br />
    <br />
    First, please indicate your agreement or disagreement with the following statements (from 1 - Strongly agree, to 5 - Strongly disagree).
    <br />
    <br />

    <div *ngFor="let quest of qs_list; index as qnum">
      <hr />
      <hr />
      <br />
      <ion-label style="font-size: 100% !important;margin-bottom:0;color:black;font-style:italic;">{{quest}}</ion-label>
      <ion-select [(ngModel)]="citP.misc_ratings[qnum]" [ngModelOptions]="{standalone: true}" interface='popover' style="font-size: 100%;" placeholder='(please choose)'>
        <ion-option value='1'>1 - Strongly agree</ion-option>
        <ion-option value='2'>2 - Agree</ion-option>
        <ion-option value='3'>3 - Neutral</ion-option>
        <ion-option value='4'>4 - Disagree</ion-option>
        <ion-option value='5'>5 - Strongly disagree</ion-option>
      </ion-select>
      <br />

    </div>
    <div *ngIf='citP.misc_ratings[14] != "9"' (swiperight)='citP.misc_ratings[14] = "9"'>
      <hr />
      <hr />
      <br />
      <ion-label style="font-size: 100% !important;margin-bottom:0;color:black;font-style:italic;">
        To demonstrate that you are paying attention, swipe right on this question.
      </ion-label>
      <ion-select [(ngModel)]="citP.misc_ratings[14]" [ngModelOptions]="{standalone: true}" interface='popover' style="font-size: 100%;" placeholder='(please choose)'>
        <ion-option value='1'>1 - Strongly agree</ion-option>
        <ion-option value='2'>2 - Agree</ion-option>
        <ion-option value='3'>3 - Neutral</ion-option>
        <ion-option value='4'>4 - Disagree</ion-option>
        <ion-option value='5'>5 - Strongly disagree</ion-option>
      </ion-select>
      <br />
    </div>
    <div *ngIf='citP.misc_ratings[14] == "9"'>
      <hr />
      <hr />
      <b>Thanks for paying attention! You can go on.</b>
      <br />
    </div>
    <hr />
    <hr />

    <br />
    <br />
    Finally, for each identity below (that were presented during the test), please rate how familiar you are with them (from 1 - not at all familiar, to 5 - very familiar).
    <br />
    <br />

    <hr />
    <hr />

    <div *ngFor="let probnum of [0,1,2,3,4,5,6,7]">
      <img style="max-height:30%;max-width:30%;vertical-align: middle;" src="{{this.citP.task_images[this.citP.the_probes[probnum]].src}}">
      <ion-select [(ngModel)]="citP.fam_ratings[probnum]" [ngModelOptions]="{standalone: true}" interface='popover' style="font-size: 100%;" placeholder='(please choose)'>
        <ion-option *ngFor="let spoint of scale_famil; index as i" value={{i+1}}>{{spoint}}</ion-option>
      </ion-select>
      <br />
      <hr />
      <hr />
    </div>

    <br />
    <br />

    <button ion-button (tap)='citP.store_data();' color='light' block>
      OK
    </button>
  </div>


  <div *ngSwitchCase="'div_results'" [ngStyle]="{'pointer-events': citP.pointev.div_results || 'none' }">

    <div [hidden]="citP.current_menu != 'm_testres'">

      <div style="clear:both;font-size:110%;text-align:center;padding-bottom:1.5vw;padding-top:1.5vw">
        Summary CIT results for <b>{{citP.cit_results.subj_id}}</b>
      </div>
      <div style="text-align:center;padding-bottom:4.5vw">
        (Date: <b>{{citP.cit_results.date}}</b>)
        <br />
        The information on this page is just for you personally, in case you are interested (i.e., we do not need this data). Below, "Probe 1" represents the suspected probe.
      </div>

      <div style="overflow-x:auto;background:#f1f1f1">
        <table class='results_table'>
          <tr>
            <th></th>
            <th>RT<sub>P&nbsp;vs&nbsp;I</sub><br /><span class='res_unit'>(ms)</span></th>
            <th>RT<sub>P&nbsp;(SD)</sub><br /><span class='res_unit'>(ms)</span></th>
            <th>RT<sub>I&nbsp;(SD)</sub><br /><span class='res_unit'>(ms)</span></th>
            <th><i>d</i><sub>CIT</sub><br /><span class='res_unit'>&nbsp;</span></th>
            <th>AR<sub>P&nbsp;vs&nbsp;I</sub><br /><span class='res_unit'>(%)</span></th>
            <th>AR<sub>P</sub><br /><span class='res_unit'>(%)</span></th>
            <th>AR<sub>I</sub><br /><span class='res_unit'>(%)</span></th>
          </tr>
          <tr *ngFor="let num of [1, 2, 3, 4, 5];">
            <td>
              Probe&nbsp;{{num}}
            </td>
            <td>
              {{citP.cit_results['probe' + num]['rt_p_vs_i']}}
            </td>
            <td>
              {{citP.cit_results['probe' + num]['rt_probe']}}&nbsp;({{citP.cit_results['probe' + num]['rt_probe_sd']}})
            </td>
            <td>
              {{citP.cit_results['probe' + num]['rt_irr']}}&nbsp;({{citP.cit_results['probe' + num]['rt_irr_sd']}})
            </td>
            <td style="color:#8b0000;">
              {{citP.cit_results['probe' + num]['dcit']}}
            </td>
            <td>
              {{citP.cit_results['probe' + num]['acc_p_vs_i']}}
            </td>
            <td>
              {{citP.cit_results['probe' + num]['acc_probe']}}
            </td>
            <td>
              {{citP.cit_results['probe' + num]['acc_irr']}}
            </td>
          </tr>
        </table>
      </div>
      <br />

      Overall accuracy rates (number of correct responses per number of all trials): {{citP.cit_results.ar_overall}}.
      <br />
      <br />
      <div (tap)="ele.class = ele.class == 'show' ? '' :  'show'" [ngClass]="{ expandable : true, hideChildren : ele.class !== 'show', showChildren : ele.class === 'show' }" #ele>
        <b>Description of variables</b>
        <span id='expand'><b>(tap to show)</b></span>
        <span id='collapse'><b>(tap to hide)</b></span>
        <div>
          Response times (for all correct responses, in milliseconds): probe RT mean minus irrelevant RT mean (RT<sub>P&nbsp;vs&nbsp;I</sub>), probe RT mean and standard deviation (RT<sub>P&nbsp;(SD)</sub>), irrelevant RT mean and standard
          deviation (RT<sub>I&nbsp;(SD)</sub>),
          uncorrected Cohen's d between all probe and all irrelevant RTs (<i>d</i><sub>CIT</sub>). Accuracy rates (ratio of correct responses compared to incorrect and too slow responses, in percentage): probe accuracy rate minus irrelevant
          accuracy
          rate (AR<sub>P&nbsp;vs&nbsp;I</sub>), probe accuracy rate (AR<sub>P</sub>), irrelevant accuracy rate (AR<sub>I</sub>). Responses with RT below 150 ms are excluded from all RT and AR analysis, except for the overall accuracy rate
          calculation. Trials (i.e., responses) from practice rounds are not included in any of the statistics above.
        </div>
      </div>

      <br />

      <div (tap)="ele2.class = ele2.class == 'show' ? '' :  'show'" [ngClass]="{ expandable : true, hideChildren : ele2.class !== 'show', showChildren : ele2.class === 'show' }" #ele2>
        <b>Evaluation using <i>d</i><sub>CIT</sub></b>
        <span id='expand'><b>(tap to show)</b></span>
        <span id='collapse'><b>(tap to hide)</b></span>
        <div>
          The <i>d</i><sub>CIT</sub> measure might be used to evaluate whether or not a given probe was recognized. The <i>d</i><sub>CIT</sub> typically falls between around −0.3 and 0.8, where a larger number always indicates a larger likelihood
          of
          the
          recognition of the given probe. As of yet, there is no established optimal cut-off value for the evaluation, but, based on a rough approximation in view of previous results, the following table depicts some possible evaluative labels for
          given boundaries.
          <br />
          <br />

          <div style="overflow-x:auto;white-space: nowrap;">
            <table class='dcit_table'>
              <tr>
                <td><i>d</i><sub>CIT</sub> > 0.4</td>
                <td>strong indication of recognition</td>
              </tr>
              <tr>
                <td><i>d</i><sub>CIT</sub> > 0.3 and <i>d</i><sub>CIT</sub>
                  <= 0.4</td>
                <td>fair indication of recognition
                </td>
              </tr>
              <tr>
                <td><i>d</i><sub>CIT</sub> > 0.1 and <i>d</i><sub>CIT</sub>
                  <= 0.3</td>
                <td>weak indication of recognition
                </td>
              </tr>
              <tr>
                <td><i>d</i><sub>CIT</sub> > 0 and <i>d</i><sub>CIT</sub>
                  <= 0.1</td>
                <td>indeterminate
                </td>
              </tr>
              <tr>
                <td><i>d</i><sub>CIT</sub> > −0.1 and <i>d</i><sub>CIT</sub>
                  <= 0</td>
                <td>weak indication of non-recognition
                </td>
              </tr>
              <tr>
                <td><i>d</i><sub>CIT</sub>
                  <= −0.1</td>
                <td>fair indication of non-recognition
                </td>
              </tr>
            </table>
          </div>

          <br />
          (There is no strong indication of innocence: a very fast probe response is no more expected in case of innocence than in case of guilt.)
        </div>
      </div>
      <br />
      <br />
      In this experiment, <i>d</i><sub>CIT</sub> for <i>Probe 1</i> (the famous identities in each block, either photo or name) should be above ca. 0.20 to consider yourself "caught", i.e., detected as recognizing some of these famous identities.
      <br />
      <br />
      For more details, see the <a href="https://github.com/gasparl/citapp_phone" target="_blank">online
        documentation</a>.
      <br />
      <br />
      <hr />
      <br />

      <div style="padding-bottom:3.5vw">
        <i>Path to full data file:</i><br />
        <div style="overflow-x:auto" class='selectable'>
          <b>{{citP.path}}</b>
        </div>
      </div>

      <div style="padding-bottom:3.5vw">
        <i>File name:</i><br />
        <div style="overflow-x:auto" class='selectable'>
          <b>{{citP.cit_results.file_nam_disp}}</b>
        </div>
      </div>
      <hr />
      <button ion-button small type='button' (tap)="goto_menu('m_sendin')" color="light" block>Get full data</button>
    </div>


    <div [hidden]="citP.current_menu != 'm_sendin'">

      <div style="font-size:110%;text-align:center;padding-bottom:1.5vw;padding-top:1.5vw">
        The test is completed, the only step left is to send your data to be stored
      </div>

      <div style="text-align:left;padding-left: 16px;padding-top:1.5vw;">
        First, please try to upload the data to the server by pressing the button below. If the upload is successful, the button will disappear and a success message will appear in its place that also contains your completion link. If the upload
        fails, you will get an error message:
        in that case either try again or send data using one of the other options below (in which case we will approve your submission manually).
      </div>
      <i>
        <p *ngIf="!internet_on" style="color: red;">It seems you are not connected to the internet.<br /></p>
      </i>
      <br />
      <span id="storefeed_id" style="color:red;">&nbsp;</span>
      <button *ngIf="notsent" ion-button type='button' (tap)="sendviaphp()" color="light" block>Send to server</button>
      <br /><br />
      <hr />
      <br />
      <div style="text-align:left;padding-left: 16px;padding-top:1.5vw;">
        The data can also be sent (shared, stored) via any chosen local application (e.g. email, cloud storage, etc.).
      </div>
      <span>&nbsp;</span>
      <button ion-button type='button' (tap)="sendviaapp()" color="light" block>Choose application</button>

      <br />
      <div style="text-align:left;padding-left: 16px;padding-top:1.5vw;">
        You can also just simply copy the data to the clipboard. Afterwards it can be pasted into any other application.
      </div>
      <span id="copyfeed_id" style="color:green;">&nbsp;</span>
      <button ion-button type='button' (tap)="to_clipboard()" color="light" block>Copy to clipboard</button>

      <br />
      <hr />
      <br />

      <div style="padding-bottom:3.5vw">
        <i>Path to all CIT results files on the device:</i><br />
        <div style="overflow-x:auto" class='selectable'>
          <b>{{citP.path}}</b>
        </div>
      </div>

      <div style="padding-bottom:3.5vw">
        <i>File name:</i><br />
        <div style="overflow-x:auto" class='selectable'>
          <b>{{citP.cit_results.file_nam_disp}}</b>
        </div>
      </div>
      <hr />
      <div style="text-align:center;padding-bottom:4.5vw">
        (Subject ID <b>{{citP.cit_results.subj_id}}</b>; Date: <b>{{citP.cit_results.date}}</b>)
      </div>
      <hr />
      <button ion-button small type='button' (tap)="goto_menu('m_testres')" color="light" block>Show main results</button>
    </div>

    <br />
    <br />
    <br />
    <br />
  </div>

  <!-- app console for testing
  <b>{{mycl}}</b>
  <br />
  <input (keypress)="onChange($event)" [(ngModel)]="to_exec" type="text" style="color:red; position:absolute;width:100%;">
  <br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
  console end -->

</ion-content>
